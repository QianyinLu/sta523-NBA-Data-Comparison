---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
library(tidyverse)


direct[is.na(direct)] <- 0  #turn NA to 0
regular <- direct$regular
playoff <- direct$playoff

regular1 <- regular[1:26,]
regular2 <- regular[27:32,]
regular3 <- regular[-c(1:32),]
final.2012 <- playoff[1:10,]
final.2017 <- playoff[11:20,]
final.2018 <- playoff[21:28,]

compare.plot <- function(game){

game.sum <- game%>%
  group_by(player)%>%
  summarize("MIN" = mean(MP) ,"PTS" = mean(PTS), "REB" = mean(TRB),
            "AST" = mean(AST), "BLK" = mean(BLK), "STL" = mean(STL), 
            "FG%" = mean(`FG%`), "3P%" = mean(`3P%`), "FT%" = mean(`FT%`))


game.diff <- rbind(data.frame(-diff(as.matrix(game.sum[,-1]))),
                   data.frame(diff(as.matrix(game.sum[,-1]))))
game.diff[game.diff < 0] <- 0 
game.diff[2,] <- -game.diff[2,]
game.summary <- cbind(game.sum[,1],game.diff)%>%
  gather(key = "category", value = "value", -player)

ggplot(game.summary, aes(x = category, y = value, group = category))+
  geom_bar(stat='identity', aes(fill= player),width = .5)+
  scale_fill_manual(name="Player", 
                    labels = c("James", "Durant"), 
                    values = c("James"="#00ba38", "Durant"="#f8766d")) + 
  labs(title= "James vs Durant Winning Comparison",
       x = "", y = "Winning Percentage")+
    coord_flip()
}

compare.plot(regular3)
```
